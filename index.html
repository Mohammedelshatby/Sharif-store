<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø±ÙŠÙ Ø§Ù„Ø¬Ù†Ø¯ÙŠ - Ù†Ø³Ø®Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¤ÙƒØ¯</title>
    <style>
        body { background: #000; color: #d4af37; font-family: Arial, sans-serif; text-align: center; padding: 10px; }
        .box { border: 3px solid #d4af37; padding: 15px; margin: 10px; background: #111; border-radius: 10px; }
        /* Ø²Ø± Ø¶Ø®Ù… Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù„Ù…Ø³ */
        .btn-main { 
            background: #d4af37; color: #000; padding: 25px 10px; 
            border: 3px solid #fff; border-radius: 15px; font-weight: bold; 
            font-size: 22px; cursor: pointer; margin: 10px 0; width: 100%;
            display: block; -webkit-appearance: none;
        }
        .btn-main:active { background: #fff; }
        /* Ø§Ù„Ù†ÙˆØ§ÙØ° ØªÙ…Ù„Ø£ Ø§Ù„Ø´Ø§Ø´Ø© */
        .full-screen { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#000; z-index:9999; padding-top: 20px; }
        input, select { width: 90%; padding: 15px; margin: 10px; font-size: 18px; border: 2px solid #d4af37; background: #222; color: #fff; border-radius: 8px; }
        .close-btn { background: #900; color: #fff; padding: 15px; width: 90%; border: none; border-radius: 8px; font-size: 18px; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; color: #fff; margin-top: 20px; }
        th, td { border: 1px solid #d4af37; padding: 10px; }
    </style>
</head>
<body>

<div class="box">
    <h1>Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø´Ø±ÙŠÙ Ø§Ù„Ø¬Ù†Ø¯ÙŠ</h1>
    <p>Ø§Ù„Ø­Ø§Ù„Ø©: <span id="statusText">Ù…ÙˆØ¸Ù</span></p>
    <button onclick="var p=prompt('ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±:'); if(p=='2525'){ document.getElementById('adminMenu').style.display='block'; document.getElementById('statusText').innerText='Ù…Ø¯ÙŠØ±'; }" style="background:none; border:1px solid #d4af37; color:#d4af37; padding:5px 10px; border-radius:5px;">ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</button>
</div>

<div class="box">
    <button class="btn-main" onclick="document.getElementById('win_item').style.display='block'">ğŸ“¦ ØªÙƒÙˆÙŠØ¯ ØµÙ†Ù Ø¬Ø¯ÙŠØ¯</button>
    <button class="btn-main" onclick="document.getElementById('win_ent').style.display='block'">ğŸ‘¥ ØªÙƒÙˆÙŠØ¯ Ø¹Ù…ÙŠÙ„/Ù…ÙˆØ±Ø¯</button>
    <button class="btn-main" onclick="actionType='ÙˆØ§Ø±Ø¯'; openMove()">ğŸ“¥ Ø¥Ø°Ù† Ø¥Ø¶Ø§ÙØ©</button>
    <button class="btn-main" onclick="actionType='ØµØ±Ù'; openMove()">ğŸ“¤ Ø¥Ø°Ù† ØµØ±Ù</button>
    <button class="btn-main" onclick="renderInv(); document.getElementById('win_inv').style.display='block'">ğŸ“Š Ø¬Ø±Ø¯ Ø§Ù„Ù…Ø®Ø²Ù†</button>
</div>

<div id="adminMenu" class="box" style="display:none; border-color: red;">
    <h2 style="color:red">âš™ ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
    <button class="btn-main" style="background:#fff; font-size:16px;" onclick="exportCSV()">ğŸ“Š ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Excel)</button>
    <button class="btn-main" style="background:red; color:#fff; font-size:16px;" onclick="localStorage.clear(); location.reload();">ğŸ—‘ ØªØµÙÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</button>
</div>

<div id="win_item" class="full-screen">
    <h2>ØªÙƒÙˆÙŠØ¯ ØµÙ†Ù</h2>
    <input type="text" id="it_n" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù">
    <input type="text" id="it_c" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù">
    <button class="btn-main" style="width:90%; margin:auto;" onclick="saveItem()">Ø­ÙØ¸ Ø§Ù„ØµÙ†Ù</button>
    <button class="close-btn" onclick="this.parentElement.style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="win_ent" class="full-screen">
    <h2>ØªÙƒÙˆÙŠØ¯ Ø¹Ù…ÙŠÙ„/Ù…ÙˆØ±Ø¯</h2>
    <select id="en_t"><option value="Ù…ÙˆØ±Ø¯">Ù…ÙˆØ±Ø¯</option><option value="Ø¹Ù…ÙŠÙ„">Ø¹Ù…ÙŠÙ„</option></select>
    <input type="text" id="en_n" placeholder="Ø§Ù„Ø§Ø³Ù…">
    <button class="btn-main" style="width:90%; margin:auto;" onclick="saveEnt()">Ø­ÙØ¸</button>
    <button class="close-btn" onclick="this.parentElement.style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="win_move" class="full-screen">
    <h2 id="moveTitle">Ø­Ø±ÙƒØ©</h2>
    <input type="text" id="mo_d" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¥Ø°Ù†">
    <select id="mo_it"></select>
    <input type="number" id="mo_q" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
    <select id="mo_en"></select>
    <button class="btn-main" style="width:90%; margin:auto;" onclick="saveMove()">ØªØ£ÙƒÙŠØ¯</button>
    <button class="close-btn" onclick="this.parentElement.style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="win_inv" class="full-screen" style="overflow-y:auto;">
    <h2>ğŸ“Š Ø§Ù„Ø¬Ø±Ø¯</h2>
    <div id="invTable"></div>
    <button class="close-btn" onclick="this.parentElement.style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<script>
    var db = JSON.parse(localStorage.getItem('SHARIF_V24')) || { items:[], logs:[], entities:[] };
    var actionType = "";

    function saveItem() {
        var n = document.getElementById('it_n').value, c = document.getElementById('it_c').value;
        if(n && c) { db.items.push({n:n, c:c}); sync(); alert('ØªÙ… Ø§Ù„Ø­ÙØ¸'); document.getElementById('win_item').style.display='none'; }
    }

    function saveEnt() {
        var t = document.getElementById('en_t').value, n = document.getElementById('en_n').value;
        if(n) { db.entities.push({t:t, n:n}); sync(); alert('ØªÙ… Ø§Ù„Ø­ÙØ¸'); document.getElementById('win_ent').style.display='none'; }
    }

    function openMove() {
        document.getElementById('moveTitle').innerText = "Ø¥Ø°Ù† " + actionType;
        document.getElementById('mo_it').innerHTML = db.items.map(i => <option value="${i.c}">${i.n}</option>).join('');
        var ents = db.entities.filter(e => (actionType=='ÙˆØ§Ø±Ø¯'? e.t=='Ù…ÙˆØ±Ø¯' : e.t=='Ø¹Ù…ÙŠÙ„'));
        document.getElementById('mo_en').innerHTML = ents.map(e => <option value="${e.n}">${e.n}</option>).join('');
        document.getElementById('win_move').style.display='block';
    }

    function saveMove() {
        var d=document.getElementById('mo_d').value, i=document.getElementById('mo_it').value, q=document.getElementById('mo_q').value, e=document.getElementById('mo_en').value;
        if(d && i && q) {
            db.logs.push({t:actionType, d:d, i:i, q:parseFloat(q), e:e});
            sync(); alert('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„'); document.getElementById('win_move').style.display='none';
        }
    }

    function renderInv() {
        var h = '<table><tr><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ø±ØµÙŠØ¯</th></tr>';
        db.items.forEach(it => {
            var b = 0;
            db.logs.forEach(l => { if(l.i==it.c) b += (l.t=='ÙˆØ§Ø±Ø¯'? l.q : -l.q); });
            h += <tr><td>${it.n}</td><td>${b}</td></tr>;
        });
        document.getElementById('invTable').innerHTML = h + '</table>';
    }

    function sync() { localStorage.setItem('SHARIF_V24', JSON.stringify(db)); }

    function exportCSV() {
        var csv = "Ø§Ù„Ù†ÙˆØ¹,Ø§Ù„Ø§Ø°Ù†,Ø§Ù„ØµÙ†Ù,Ø§Ù„ÙƒÙ…ÙŠØ©,Ø§Ù„Ø¬Ù‡Ø©\n";
        db.logs.forEach(l => { csv += ${l.t},${l.d},${l.i},${l.q},${l.e}\n; });
        var blob = new Blob([new Uint8Array([0xEF, 0xBB, 0xBF]), csv], {type: 'text/csv;charset=utf-8'});
        var link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "report.csv";
        link.click();
    }
</script>

</body>
</html>
