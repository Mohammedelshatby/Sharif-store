<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø±ÙŠÙ Ø§Ù„Ø¬Ù†Ø¯ÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ÙØ¹Ù„Ø© ÙÙˆØ±Ø§Ù‹</title>
    <style>
        :root { --gold: #d4af37; --black: #0c0c0c; --dark: #1a1a1a; }
        body { font-family: sans-serif; background: var(--black); color: white; margin: 0; direction: rtl; text-align: right; }
        header { background: var(--dark); border-bottom: 3px solid var(--gold); padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .sidebar { width: 250px; background: var(--dark); padding: 20px; height: 100vh; float: right; border-left: 1px solid #333; }
        .main { margin-right: 290px; padding: 20px; }
        .btn { width: 100%; padding: 15px; margin-bottom: 10px; background: none; color: var(--gold); border: 1px solid var(--gold); cursor: pointer; font-weight: bold; border-radius: 5px; text-align: right; }
        .btn:hover { background: var(--gold); color: black; }
        input, select { width: 100%; padding: 10px; margin: 10px 0; background: #222; border: 1px solid var(--gold); color: white; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background: var(--gold); color: black; padding: 10px; }
        td { border: 1px solid #444; padding: 10px; text-align: center; }
        .modal { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:var(--dark); padding:25px; border:2px solid var(--gold); z-index:100; width:80%; border-radius:10px; }
        .overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:50; }
        #adminPanel { display:none; border: 2px dashed var(--gold); padding: 20px; margin-top: 20px; background: #050505; }
    </style>
</head>
<body>

<header>
    <h1 id="titleDisplay">Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø´Ø±ÙŠÙ Ø§Ù„Ø¬Ù†Ø¯ÙŠ</h1>
    <div id="status" style="color:var(--gold)">ğŸ‘¤ ÙˆØ¶Ø¹ Ø§Ù„Ù…ÙˆØ¸Ù</div>
</header>

<div class="sidebar">
    <button class="btn" onclick="document.getElementById('modalIt').style.display='block'; document.getElementById('over').style.display='block';">ğŸ“¦ ØªÙƒÙˆÙŠØ¯ ØµÙ†Ù</button>
    <button class="btn" onclick="openAction('ÙˆØ§Ø±Ø¯')">ğŸ“¥ Ø¥Ø°Ù† Ø¥Ø¶Ø§ÙØ©</button>
    <button class="btn" onclick="openAction('ØµØ±Ù')">ğŸ“¤ Ø¥Ø°Ù† ØµØ±Ù</button>
    <button class="btn" onclick="showInventory()">ğŸ“Š Ø¬Ø±Ø¯ Ø§Ù„Ù…Ø®Ø²Ù†</button>
    <hr>
    <button id="adminLogBtn" class="btn" style="background:var(--gold); color:black;" onclick="checkAdmin()">ğŸ” Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±</button>
    <button class="btn" style="border-color:red; color:red;" onclick="location.reload()">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù…</button>
</div>

<div class="main">
    <div id="adminPanel">
        <h3>âš™ ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ÙƒØ§Ù…Ù„</h3>
        <input type="text" id="storeNameInput" placeholder="ØªØºÙŠÙŠØ± Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø´Ø£Ø©">
        <button class="btn" style="width:200px" onclick="updateTitle()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù…</button>
        <div id="fullLogs"></div>
    </div>
    <div id="content">
        <h2>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ..</h2>
        <p>Ø¥Ø°Ø§ Ù„Ù… ØªØ¹Ù…Ù„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±ØŒ Ø§Ø¶ØºØ· "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù…" Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©.</p>
    </div>
</div>

<div id="over" class="overlay" onclick="closeAll()"></div>

<div id="modalIt" class="modal">
    <h3>Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯</h3>
    <input type="text" id="itName" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù">
    <input type="text" id="itCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù">
    <button class="btn" onclick="saveItem()">Ø­ÙØ¸ Ø§Ù„ØµÙ†Ù</button>
</div>

<div id="modalAction" class="modal">
    <h3 id="actionTitle">Ø­Ø±ÙƒØ© Ù…Ø®Ø²Ù†</h3>
    <select id="actionSelectIt"></select>
    <input type="number" id="actionQty" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
    <input type="text" id="actionClient" placeholder="Ø§Ù„Ø¬Ù‡Ø© (Ù…ÙˆØ±Ø¯/Ø¹Ù…ÙŠÙ„)">
    <button class="btn" onclick="saveLog()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</button>
</div>

<div id="modalInv" class="modal">
    <h3>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¬Ø±Ø¯</h3>
    <div id="invTableDiv"></div>
</div>

<script>
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
    var db = JSON.parse(localStorage.getItem('SHARIF_V14')) || {
        name: "Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø´Ø±ÙŠÙ Ø§Ù„Ø¬Ù†Ø¯ÙŠ",
        items: [],
        logs: []
    };
    var currentType = '';

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ ÙÙˆØ± Ø§Ù„ØªØ­Ù…ÙŠÙ„
    document.getElementById('titleDisplay').innerText = db.name;

    function saveItem() {
        var n = document.getElementById('itName').value;
        var c = document.getElementById('itCode').value;
        if(n && c) {
            db.items.push({n: n, c: c});
            saveAndRefresh();
            alert("ØªÙ… Ø§Ù„ØªÙƒÙˆÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­");
            closeAll();
        }
    }

    function openAction(type) {
        currentType = type;
        document.getElementById('actionTitle').innerText = "ØªØ³Ø¬ÙŠÙ„ " + type;
        var sel = document.getElementById('actionSelectIt');
        sel.innerHTML = db.items.map(i => <option value="${i.c}">${i.n}</option>).join('');
        document.getElementById('modalAction').style.display = 'block';
        document.getElementById('over').style.display = 'block';
    }

    function saveLog() {
        var c = document.getElementById('actionSelectIt').value;
        var q = document.getElementById('actionQty').value;
        var cl = document.getElementById('actionClient').value;
        if(c && q) {
            db.logs.push({id: Date.now(), c: c, q: parseFloat(q), t: currentType, cl: cl, d: new Date().toLocaleString()});
            saveAndRefresh();
            alert("ØªÙ… Ø§Ù„Ø­ÙØ¸");
            closeAll();
        }
    }

    function showInventory() {
        var html = '<table><tr><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ø±ØµÙŠØ¯</th></tr>';
        db.items.forEach(it => {
            var bal = 0;
            db.logs.forEach(l => { if(l.c == it.c) bal += (l.t == 'ÙˆØ§Ø±Ø¯' ? l.q : -l.q); });
            html += <tr><td>${it.n}</td><td>${bal}</td></tr>;
        });
        document.getElementById('invTableDiv').innerHTML = html + '</table>';
        document.getElementById('modalInv').style.display = 'block';
        document.getElementById('over').style.display = 'block';
    }

    function checkAdmin() {
        var p = prompt("Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø³Ø± Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø®ÙÙŠØ©:");
        if(p === "2525") {
            document.getElementById('adminPanel').style.display = 'block';
            document.getElementById('status').innerText = "ğŸ‘‘ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ±";
            renderAdminLogs();
        } else { alert("Ø®Ø·Ø£!"); }
    }

    function renderAdminLogs() {
        var html = '<table><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø­Ø°Ù</th></tr>';
        db.logs.forEach(l => {
            html += <tr><td>${l.d}</td><td>${l.t}</td><td>${l.q}</td><td><button onclick="delLog(${l.id})" style="color:red">X</button></td></tr>;
        });
        document.getElementById('fullLogs').innerHTML = html + '</table>';
    }

    function delLog(id) {
        if(confirm("Ø­Ø°ÙØŸ")) {
            db.logs = db.logs.filter(x => x.id !== id);
            saveAndRefresh();
            renderAdminLogs();
        }
    }

    function updateTitle() {
        var nt = document.getElementById('storeNameInput').value;
        if(nt) { db.name = nt; document.getElementById('titleDisplay').innerText = nt; saveAndRefresh(); }
    }

    function saveAndRefresh() {
        localStorage.setItem('SHARIF_V14', JSON.stringify(db));
    }

    function closeAll() {
        document.getElementById('modalIt').style.display = 'none';
        document.getElementById('modalAction').style.display = 'none';
        document.getElementById('modalInv').style.display = 'none';
        document.getElementById('over').style.display = 'none';
    }
</script>
</body>
</html>
