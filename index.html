<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø±ÙŠÙ Ø§Ù„Ø¬Ù†Ø¯ÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ© V19</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { background: #000; color: #d4af37; font-family: sans-serif; text-align: center; margin: 0; padding: 10px; }
        .container { border: 2px solid #d4af37; padding: 15px; background: #111; border-radius: 10px; margin-bottom: 10px; }
        .btn { 
            background: #d4af37; color: #000; padding: 15px; 
            border: 2px solid #fff; border-radius: 8px; font-weight: bold; 
            font-size: 18px; cursor: pointer; margin: 5px; width: 90%; max-width: 300px;
            display: inline-block;
        }
        .btn:active { background: #fff; }
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9999; padding-top: 20px; overflow-y:auto; }
        input, select { width: 85%; padding: 12px; margin: 10px 0; background: #222; color: #fff; border: 1px solid #d4af37; font-size: 16px; }
        table { width: 100%; border-collapse: collapse; color: #fff; background: #111; }
        th, td { border: 1px solid #d4af37; padding: 10px; text-align: center; }
        .admin-only { display: none; border: 2px dashed red; padding: 10px; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1 id="mainTitle">Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø´Ø±ÙŠÙ Ø§Ù„Ø¬Ù†Ø¯ÙŠ</h1>
    <p id="userLabel">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ: Ù…ÙˆØ¸Ù</p>
    <button class="btn" style="background:#444; color:white;" onclick="var p=prompt('Ø¨Ø§Ø³ÙˆØ±Ø¯ Ø§Ù„Ù…Ø¯ÙŠØ±:'); if(p=='2525'){ document.getElementById('adminZone').style.display='block'; document.getElementById('userLabel').innerText='Ø§Ù„ÙˆØ¶Ø¹: Ù…Ø¯ÙŠØ±'; alert('ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„'); }else{alert('Ø®Ø·Ø£');}">ğŸ”‘ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ± (2525)</button>
    <button class="btn" style="background:red; color:white; width:100px;" onclick="location.reload()">ğŸ”„ Ø±ÙŠÙØ±Ø´</button>
</div>

<div class="container">
    <button class="btn" onclick="document.getElementById('m_add_item').style.display='block'">ğŸ“¦ ØªÙƒÙˆÙŠØ¯ ØµÙ†Ù</button>
    <button class="btn" onclick="openMove('ÙˆØ§Ø±Ø¯')">ğŸ“¥ Ø¥Ø°Ù† Ø¥Ø¶Ø§ÙØ©</button>
    <button class="btn" onclick="openMove('ØµØ±Ù')">ğŸ“¤ Ø¥Ø°Ù† ØµØ±Ù</button>
    <button class="btn" onclick="renderInv()">ğŸ“Š Ø¬Ø±Ø¯ Ø§Ù„Ù…Ø®Ø²Ù†</button>
</div>

<div id="adminZone" class="admin-only">
    <h2 style="color:red">âš™ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
    <button class="btn" onclick="exportExcel()">ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø¥ÙƒØ³ÙŠÙ„</button>
    <button class="btn" onclick="renderAdminTools()">âœ ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù Ø§Ù„Ø£ØµÙ†Ø§Ù</button>
    <div id="adminDisplay"></div>
</div>

<div id="m_add_item" class="modal">
    <h2>ØªÙƒÙˆÙŠØ¯ ØµÙ†Ù Ø¬Ø¯ÙŠØ¯</h2>
    <input type="text" id="it_name" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù">
    <input type="text" id="it_code" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù">
    <button class="btn" onclick="saveNewItem()">Ø­ÙØ¸</button>
    <button class="btn" style="background:red" onclick="this.parentElement.style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="m_move" class="modal">
    <h2 id="move_title">Ø­Ø±ÙƒØ©</h2>
    <input type="text" id="doc_id" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¥Ø°Ù†">
    <select id="move_select"></select>
    <input type="number" id="move_qty" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
    <input type="text" id="move_cl" placeholder="Ø§Ù„Ø¬Ù‡Ø©">
    <button class="btn" onclick="saveMove()">ØªØ£ÙƒÙŠØ¯</button>
    <button class="btn" style="background:red" onclick="this.parentElement.style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="m_inv" class="modal">
    <h2>ğŸ“Š Ø§Ù„Ø¬Ø±Ø¯ ÙˆØ§Ù„Ø¨Ø­Ø«</h2>
    <input type="text" placeholder="Ø¨Ø­Ø«..." onkeyup="searchInv(this.value)">
    <div id="inv_box"></div>
    <button class="btn" style="background:red" onclick="this.parentElement.style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<script>
    var db = JSON.parse(localStorage.getItem('SHARIF_DB_V19')) || { name:"Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø´Ø±ÙŠÙ Ø§Ù„Ø¬Ù†Ø¯ÙŠ", items:[], logs:[] };
    var activeMove = "";

    function saveNewItem() {
        var n = document.getElementById('it_name').value;
        var c = document.getElementById('it_code').value;
        if(n && c) {
            db.items.push({n:n, c:c});
            save(); alert("ØªÙ… Ø§Ù„ØªÙƒÙˆÙŠØ¯"); document.getElementById('m_add_item').style.display='none';
        }
    }

    function openMove(t) {
        activeMove = t;
        document.getElementById('move_title').innerText = "Ø¥Ø°Ù† " + t;
        var s = document.getElementById('move_select');
        s.innerHTML = db.items.map(i => <option value="${i.c}">${i.n}</option>).join('');
        document.getElementById('m_move').style.display='block';
    }

    function saveMove() {
        var d = document.getElementById('doc_id').value;
        var c = document.getElementById('move_select').value;
        var q = document.getElementById('move_qty').value;
        if(d && c && q) {
            db.logs.push({doc:d, c:c, q:parseFloat(q), t:activeMove, dt:new Date().toLocaleString()});
            save(); alert("ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„"); document.getElementById('m_move').style.display='none';
        }
    }

    function renderInv() {
        var h = '<table><tr><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ø±ØµÙŠØ¯</th></tr>';
        db.items.forEach(i => {
            var b = 0;
            db.logs.forEach(l => { if(l.c==i.c) b += (l.t=='ÙˆØ§Ø±Ø¯'? l.q : -l.q); });
            h += <tr><td>${i.n}</td><td>${b}</td></tr>;
        });
        document.getElementById('inv_box').innerHTML = h + '</table>';
        document.getElementById('m_inv').style.display='block';
    }

    function renderAdminTools() {
        var h = '<h3>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£ØµÙ†Ø§Ù</h3><table>';
        db.items.forEach((i, idx) => {
            h += <tr><td>${i.n}</td><td><button onclick="db.items.splice(${idx},1);save();renderAdminTools();" style="color:red">Ø­Ø°Ù</button></td></tr>;
        });
        document.getElementById('adminDisplay').innerHTML = h + '</table>';
    }

    function save() { localStorage.setItem('SHARIF_DB_V19', JSON.stringify(db)); }
    function exportExcel() {
        var ws = XLSX.utils.json_to_sheet(db.logs);
        var wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Logs");
        XLSX.writeFile(wb, "Sharif_Report.xlsx");
    }
</script>
</body>
</html>
